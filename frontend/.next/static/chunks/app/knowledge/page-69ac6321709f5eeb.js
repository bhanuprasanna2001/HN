(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{960:(e,t,r)=>{"use strict";async function l(e,t){let r=await fetch("".concat("/api").concat(e),{headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},...t});if(!r.ok)throw Error((await r.json().catch(()=>({}))).detail||"Request failed: ".concat(r.status));return r.json()}function n(){return l("/stats")}function a(e){return l("/copilot/ask",{method:"POST",body:JSON.stringify({question:e})})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=new URLSearchParams({page:String(e),search:t});return l("/knowledge/articles?".concat(r))}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:80;return l("/knowledge/graph?limit=".concat(e))}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=new URLSearchParams({status:e,page:String(t)});return l("/learning/events?".concat(r))}function i(e){return l("/learning/generate-draft",{method:"POST",body:JSON.stringify({ticket_number:e})})}function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return l("/learning/review",{method:"POST",body:JSON.stringify({event_id:e,action:t,reviewer_notes:r})})}function d(e){return l("/qa/score",{method:"POST",body:JSON.stringify({ticket_number:e})})}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=new URLSearchParams({page:String(e),search:t,status:r});return l("/tickets?".concat(n))}r.d(t,{DM:()=>s,Fq:()=>o,H2:()=>d,Ls:()=>u,PF:()=>i,WS:()=>x,YK:()=>n,mF:()=>a,wV:()=>c})},1578:(e,t,r)=>{"use strict";function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var e,t,r=0,l="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,l,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(l=e(t[r]))&&(n&&(n+=" "),n+=l)}else for(l in t)t[l]&&(n&&(n+=" "),n+=l);return n}(e))&&(l&&(l+=" "),l+=t);return l}(t)}function n(e){return new Intl.NumberFormat().format(e)}function a(e,t){return e.length<=t?e:e.slice(0,t-1)+"…"}function o(e){var t;return null!=(t=({kb_article:"#3B82F6",script:"#8B5CF6",ticket:"#10B981",conversation:"#F59E0B"})[e])?t:"#737373"}function s(e){let t=e.toLowerCase();return"approved"===t?"bg-emerald-50 text-emerald-700 border-emerald-200":"rejected"===t?"bg-red-50 text-red-700 border-red-200":"pending"===t?"bg-amber-50 text-amber-700 border-amber-200":"closed"===t?"bg-neutral-100 text-neutral-600 border-neutral-200":"bg-neutral-50 text-neutral-600 border-neutral-200"}r.d(t,{cn:()=>l,ZV:()=>n,_k:()=>o,ST:()=>s,xv:()=>a})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var l=r(2115);let n=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,l.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:c,className:i="",children:u,iconNode:d,...x}=e;return(0,l.createElement)("svg",{ref:t,...o,width:n,height:n,stroke:r,strokeWidth:c?24*Number(s)/Number(n):s,className:a("lucide",i),...!u&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(x)&&{"aria-hidden":"true"},...x},[...d.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),c=(e,t)=>{let r=(0,l.forwardRef)((r,o)=>{let{className:c,...i}=r;return(0,l.createElement)(s,{ref:o,iconNode:t,className:a("lucide-".concat(n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...i})});return r.displayName=n(e),r}},2317:(e,t,r)=>{Promise.resolve().then(r.bind(r,9234))},6651:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});let l=(0,r(1847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},7937:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});let l=(0,r(1847).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},9234:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var l=r(5155),n=r(2115),a=r(6651),o=r(7937),s=r(960),c=r(1578);function i(e){let{nodes:t,links:r,width:a,height:o,onNodeClick:s}=e,i=(0,n.useRef)(null),u=(0,n.useRef)(0),d=(0,n.useRef)([]),x=(0,n.useRef)([]),m=(0,n.useRef)(null),[h,f]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=new Map,l=t.map((r,l)=>{let n=2*Math.PI*l/t.length,s=.35*Math.min(a,o),c={...r,x:a/2+s*Math.cos(n)+(Math.random()-.5)*40,y:o/2+s*Math.sin(n)+(Math.random()-.5)*40,vx:0,vy:0};return e.set(r.id,c),c}),n=r.map(t=>{var r,l;return{source:null!=(r=e.get(t.source))?r:t.source,target:null!=(l=e.get(t.target))?l:t.target,relationship:t.relationship}}).filter(e=>"string"!=typeof e.source&&"string"!=typeof e.target);d.current=l,x.current=n},[t,r,a,o]);let v=(0,n.useCallback)(()=>{var e,t,r,l,n,s,c,i,u,m,h,f,v,p,b,g,y,j,N,k,w,S,C,_;let A=d.current,M=x.current,E=a/2,B=o/2;for(let a=0;a<A.length;a++)for(let o=a+1;o<A.length;o++){let u=(null!=(e=A[a].x)?e:0)-(null!=(t=A[o].x)?t:0),d=(null!=(r=A[a].y)?r:0)-(null!=(l=A[o].y)?l:0),x=Math.sqrt(u*u+d*d)||1,m=800/(x*x),h=u/x*m,f=d/x*m;A[a].vx=(null!=(n=A[a].vx)?n:0)+h,A[a].vy=(null!=(s=A[a].vy)?s:0)+f,A[o].vx=(null!=(c=A[o].vx)?c:0)-h,A[o].vy=(null!=(i=A[o].vy)?i:0)-f}for(let e of M){let t=e.source,r=e.target,l=(null!=(u=r.x)?u:0)-(null!=(m=t.x)?m:0),n=(null!=(h=r.y)?h:0)-(null!=(f=t.y)?f:0),a=Math.sqrt(l*l+n*n)||1,o=(a-120)*.005,s=l/a*o,c=n/a*o;t.vx=(null!=(v=t.vx)?v:0)+s,t.vy=(null!=(p=t.vy)?p:0)+c,r.vx=(null!=(b=r.vx)?b:0)-s,r.vy=(null!=(g=r.vy)?g:0)-c}for(let e of A)e.vx=((null!=(y=e.vx)?y:0)+(E-(null!=(j=e.x)?j:0))*.001)*.92,e.vy=((null!=(N=e.vy)?N:0)+(B-(null!=(k=e.y)?k:0))*.001)*.92,e.x=(null!=(w=e.x)?w:0)+(null!=(S=e.vx)?S:0),e.y=(null!=(C=e.y)?C:0)+(null!=(_=e.vy)?_:0),e.x=Math.max(20,Math.min(a-20,e.x)),e.y=Math.max(20,Math.min(o-20,e.y))},[a,o]);return(0,n.useEffect)(()=>{let e=i.current;if(!e)return;let t=e.getContext("2d");if(t)return u.current=requestAnimationFrame(function e(){var r,l,n,s,i,h,f,p;if(!t)return;for(let e of(v(),t.clearRect(0,0,a,o),t.strokeStyle="#E5E5E5",t.lineWidth=1,x.current)){let a=e.source,o=e.target;t.beginPath(),t.moveTo(null!=(r=a.x)?r:0,null!=(l=a.y)?l:0),t.lineTo(null!=(n=o.x)?n:0,null!=(s=o.y)?s:0),t.stroke()}let b=m.current;for(let e of d.current){let r=e===b?8:5,l=(0,c._k)(e.group);t.beginPath(),t.arc(null!=(i=e.x)?i:0,null!=(h=e.y)?h:0,r,0,2*Math.PI),t.fillStyle=l,t.fill(),e===b&&(t.strokeStyle=l,t.lineWidth=2,t.stroke())}b&&(t.font="11px Inter, sans-serif",t.fillStyle="#252525",t.textAlign="center",t.fillText(b.label,null!=(f=b.x)?f:0,(null!=(p=b.y)?p:0)-12)),u.current=requestAnimationFrame(e)}),()=>cancelAnimationFrame(u.current)},[a,o,v]),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("canvas",{ref:i,width:a,height:o,className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]",style:{cursor:h?"pointer":"default"},onMouseMove:function(e){let t=i.current;if(!t)return;let r=t.getBoundingClientRect(),l=e.clientX-r.left,n=e.clientY-r.top,a=null;for(let e of d.current){var o,s;let t=(null!=(o=e.x)?o:0)-l,r=(null!=(s=e.y)?s:0)-n;if(t*t+r*r<100){a=e;break}}m.current=a,f(a)},onClick:function(){m.current&&s&&s(m.current)}}),(0,l.jsx)("div",{className:"absolute bottom-3 left-3 flex gap-4 rounded-md bg-white/90 px-3 py-2 text-[11px] backdrop-blur-sm",children:[{label:"KB Article",color:"#3B82F6"},{label:"Script",color:"#8B5CF6"},{label:"Ticket",color:"#10B981"},{label:"Conversation",color:"#F59E0B"}].map(e=>{let{label:t,color:r}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)("span",{className:"inline-block h-2.5 w-2.5 rounded-full",style:{backgroundColor:r}}),(0,l.jsx)("span",{className:"text-[var(--color-text-muted)]",children:t})]},t)})}),h&&(0,l.jsxs)("div",{className:"absolute right-3 top-3 max-w-64 rounded-md border border-[var(--color-border)] bg-white p-3 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"inline-block h-2 w-2 rounded-full",style:{backgroundColor:(0,c._k)(h.group)}}),(0,l.jsx)("span",{className:"text-[11px] font-medium capitalize text-[var(--color-text-muted)]",children:h.group.replace("_"," ")})]}),(0,l.jsx)("p",{className:"mt-1 text-xs font-medium text-[var(--color-text)]",children:h.label}),(0,l.jsx)("p",{className:"mt-0.5 font-mono text-[10px] text-[var(--color-text-muted)]",children:h.id})]})]})}function u(){let[e,t]=(0,n.useState)(null),[r,u]=(0,n.useState)([]),[d,x]=(0,n.useState)(0),[m,h]=(0,n.useState)(""),[f,v]=(0,n.useState)(1),[p,b]=(0,n.useState)(null),[g,y]=(0,n.useState)(!0),j=(0,n.useRef)(null),[N,k]=(0,n.useState)(800);return(0,n.useEffect)(()=>{(0,s.DM)(100).then(t).catch(()=>{})},[]),(0,n.useEffect)(()=>{y(!0),(0,s.Fq)(f,m).then(e=>{u(e.data),x(e.meta.total)}).catch(()=>{}).finally(()=>y(!1))},[f,m]),(0,n.useEffect)(()=>{function e(){j.current&&k(j.current.offsetWidth)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Knowledge Base"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-[var(--color-text-muted)]",children:"Explore the knowledge graph and browse articles with full provenance"})]}),(0,l.jsxs)("div",{ref:j,className:"mb-8",children:[(0,l.jsx)("h2",{className:"mb-3 text-sm font-semibold text-[var(--color-text)]",children:"Knowledge Graph"}),e&&e.nodes.length>0?(0,l.jsx)(i,{nodes:e.nodes,links:e.links,width:N,height:420,onNodeClick:b}):(0,l.jsx)("div",{className:"flex h-64 items-center justify-center rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]",children:(0,l.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[var(--color-accent)] border-t-transparent"})})]}),p&&(0,l.jsxs)("div",{className:"mb-6 rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)] p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"inline-block h-3 w-3 rounded-full",style:{backgroundColor:(0,c.cn)("kb_article"===p.group?"#3B82F6":"script"===p.group?"#8B5CF6":"ticket"===p.group?"#10B981":"#F59E0B")}}),(0,l.jsx)("span",{className:"text-xs font-medium capitalize text-[var(--color-text-muted)]",children:p.group.replace("_"," ")})]}),(0,l.jsx)("button",{onClick:()=>b(null),className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text)]",children:"Close"})]}),(0,l.jsx)("p",{className:"mt-2 text-sm font-medium text-[var(--color-text)]",children:p.label}),(0,l.jsx)("p",{className:"mt-1 font-mono text-xs text-[var(--color-text-muted)]",children:p.id})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,l.jsxs)("h2",{className:"text-sm font-semibold text-[var(--color-text)]",children:["Articles (",d,")"]}),(0,l.jsxs)("div",{className:"relative ml-auto w-64",children:[(0,l.jsx)(a.A,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)]"}),(0,l.jsx)("input",{value:m,onChange:e=>{h(e.target.value),v(1)},placeholder:"Search articles…",className:"w-full rounded-md border border-[var(--color-border)] bg-[var(--color-bg)] py-2 pl-9 pr-3 text-xs text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:border-[var(--color-accent)] focus:outline-none"})]})]}),g?(0,l.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,l.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[var(--color-accent)] border-t-transparent"})}):(0,l.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,l.jsxs)("div",{className:"flex items-start gap-3 rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)] p-4 transition-colors hover:bg-neutral-50",children:[(0,l.jsx)(o.A,{size:16,strokeWidth:1.6,className:"mt-0.5 shrink-0 text-blue-500"}),(0,l.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-[var(--color-text)]",children:e.Title||e.KB_Article_ID}),(0,l.jsx)("p",{className:"mt-1 text-xs leading-relaxed text-[var(--color-text-muted)]",children:(0,c.xv)(e.Body||"",180)}),(0,l.jsxs)("div",{className:"mt-2 flex items-center gap-3",children:[(0,l.jsx)("span",{className:"font-mono text-[10px] text-[var(--color-text-muted)]",children:e.KB_Article_ID}),e.Module&&(0,l.jsx)("span",{className:"rounded-full bg-neutral-100 px-2 py-0.5 text-[10px] text-[var(--color-text-muted)]",children:e.Module}),e.Source_Type&&(0,l.jsx)("span",{className:"rounded-full bg-blue-50 px-2 py-0.5 text-[10px] text-blue-600",children:e.Source_Type})]})]})]},e.KB_Article_ID))}),d>20&&(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>v(e=>Math.max(1,e-1)),disabled:1===f,className:"rounded-md border border-[var(--color-border)] px-3 py-1.5 text-xs text-[var(--color-text-muted)] hover:bg-neutral-50 disabled:opacity-40",children:"Previous"}),(0,l.jsxs)("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Page ",f," of ",Math.ceil(d/20)]}),(0,l.jsx)("button",{onClick:()=>v(e=>e+1),disabled:f>=Math.ceil(d/20),className:"rounded-md border border-[var(--color-border)] px-3 py-1.5 text-xs text-[var(--color-text-muted)] hover:bg-neutral-50 disabled:opacity-40",children:"Next"})]})]})]})}}},e=>{e.O(0,[441,255,358],()=>e(e.s=2317)),_N_E=e.O()}]);