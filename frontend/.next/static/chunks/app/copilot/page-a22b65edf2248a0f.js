(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[137],{960:(e,t,r)=>{"use strict";async function n(e,t){let r=await fetch("".concat("/api").concat(e),{headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},...t});if(!r.ok)throw Error((await r.json().catch(()=>({}))).detail||"Request failed: ".concat(r.status));return r.json()}function s(){return n("/stats")}function a(e){return n("/copilot/ask",{method:"POST",body:JSON.stringify({question:e})})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=new URLSearchParams({page:String(e),search:t});return n("/knowledge/articles?".concat(r))}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:80;return n("/knowledge/graph?limit=".concat(e))}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=new URLSearchParams({status:e,page:String(t)});return n("/learning/events?".concat(r))}function i(e){return n("/learning/generate-draft",{method:"POST",body:JSON.stringify({ticket_number:e})})}function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return n("/learning/review",{method:"POST",body:JSON.stringify({event_id:e,action:t,reviewer_notes:r})})}function u(e){return n("/qa/score",{method:"POST",body:JSON.stringify({ticket_number:e})})}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=new URLSearchParams({page:String(e),search:t,status:r});return n("/tickets?".concat(s))}r.d(t,{DM:()=>l,Fq:()=>o,H2:()=>u,Ls:()=>d,PF:()=>i,WS:()=>x,YK:()=>s,mF:()=>a,wV:()=>c})},1578:(e,t,r)=>{"use strict";function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,n,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(n=e(t[r]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}(e))&&(n&&(n+=" "),n+=t);return n}(t)}function s(e){return new Intl.NumberFormat().format(e)}function a(e,t){return e.length<=t?e:e.slice(0,t-1)+"…"}function o(e){var t;return null!=(t=({kb_article:"#3B82F6",script:"#8B5CF6",ticket:"#10B981",conversation:"#F59E0B"})[e])?t:"#737373"}function l(e){let t=e.toLowerCase();return"approved"===t?"bg-emerald-50 text-emerald-700 border-emerald-200":"rejected"===t?"bg-red-50 text-red-700 border-red-200":"pending"===t?"bg-amber-50 text-amber-700 border-amber-200":"closed"===t?"bg-neutral-100 text-neutral-600 border-neutral-200":"bg-neutral-50 text-neutral-600 border-neutral-200"}r.d(t,{cn:()=>n,ZV:()=>s,_k:()=>o,ST:()=>l,xv:()=>a})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(2115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:i="",children:d,iconNode:u,...x}=e;return(0,n.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:r,strokeWidth:c?24*Number(l)/Number(s):l,className:a("lucide",i),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(x)&&{"aria-hidden":"true"},...x},[...u.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,n.forwardRef)((r,o)=>{let{className:c,...i}=r;return(0,n.createElement)(l,{ref:o,iconNode:t,className:a("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...i})});return r.displayName=s(e),r}},4086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var n=r(5155),s=r(2115),a=r(1847);let o=(0,a.A)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),l=(0,a.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),c=(0,a.A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var i=r(960),d=r(1578);function u(e){let{source:t}=e,r=(0,d._k)(t.doc_type),s="kb_article"===t.doc_type?"KB Article":"script"===t.doc_type?"Script":"Ticket";return(0,n.jsxs)("div",{className:"rounded-md border border-[var(--color-border)] bg-[var(--color-bg)] p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"inline-block h-2 w-2 rounded-full",style:{backgroundColor:r}}),(0,n.jsx)("span",{className:"text-[11px] font-medium text-[var(--color-text-muted)]",children:s}),(0,n.jsxs)("span",{className:"ml-auto text-[11px] font-mono text-[var(--color-text-muted)]",children:[(100*t.score).toFixed(0),"% match"]})]}),(0,n.jsx)("p",{className:"mt-1.5 text-xs font-medium text-[var(--color-text)]",children:t.title||t.id}),(0,n.jsx)("p",{className:"mt-1 text-[11px] leading-relaxed text-[var(--color-text-muted)]",children:(0,d.xv)(t.snippet,200)}),(0,n.jsxs)("p",{className:"mt-1.5 font-mono text-[10px] text-[var(--color-text-muted)]",children:["ID: ",t.id]})]})}function x(){let[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(""),[x,m]=(0,s.useState)(!1),h=(0,s.useRef)(null);async function p(){let e=r.trim();if(e&&!x){a(""),t(t=>[...t,{role:"user",content:e}]),m(!0),t(e=>[...e,{role:"assistant",content:"",loading:!0}]);try{let r=await (0,i.mF)(e);t(e=>{let t=[...e];return t[t.length-1]={role:"assistant",content:r.answer,response:r},t})}catch(e){t(t=>{let r=[...t];return r[r.length-1]={role:"assistant",content:"Error: ".concat(e instanceof Error?e.message:"Unknown error")},r})}finally{m(!1)}}}return(0,s.useEffect)(()=>{var e;null==(e=h.current)||e.scrollIntoView({behavior:"smooth"})},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"AI Copilot"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-[var(--color-text-muted)]",children:"Ask questions — answers are grounded in KB articles, scripts, and resolved tickets"})]}),(0,n.jsxs)("div",{className:"flex h-[calc(100vh-14rem)] flex-col rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]",children:[(0,n.jsxs)("div",{className:"flex-1 space-y-6 overflow-y-auto p-6",children:[0===e.length&&(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(o,{size:32,strokeWidth:1.2,className:"mx-auto mb-3 text-[var(--color-text-muted)]"}),(0,n.jsx)("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Ask a support question to get started"}),(0,n.jsx)("p",{className:"mt-1 text-xs text-[var(--color-text-muted)]",children:'e.g. "How do I advance the property date in PropertySuite Affordable?"'})]})}),e.map((e,t)=>(0,n.jsxs)("div",{className:(0,d.cn)("flex gap-3","user"===e.role&&"justify-end"),children:["assistant"===e.role&&(0,n.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-[var(--color-accent)]",children:(0,n.jsx)(o,{size:14,className:"text-white"})}),(0,n.jsx)("div",{className:(0,d.cn)("max-w-2xl","user"===e.role&&"rounded-lg bg-[var(--color-accent)] px-4 py-2.5 text-sm text-white"),children:e.loading?(0,n.jsxs)("div",{className:"flex items-center gap-2 py-2",children:[(0,n.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-[var(--color-accent)] border-t-transparent"}),(0,n.jsx)("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Searching knowledge base…"})]}):"assistant"===e.role?(0,n.jsxs)("div",{children:[e.response&&(0,n.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,n.jsxs)("span",{className:(0,d.cn)("rounded-full px-2 py-0.5 text-[10px] font-medium",e.response.confidence>=.5?"bg-emerald-50 text-emerald-700":e.response.confidence>=.3?"bg-amber-50 text-amber-700":"bg-red-50 text-red-700"),children:[(100*e.response.confidence).toFixed(0),"% confidence"]}),(0,n.jsx)("span",{className:"rounded-full bg-neutral-100 px-2 py-0.5 text-[10px] font-medium text-[var(--color-text-muted)]",children:e.response.answer_type})]}),(0,n.jsx)("div",{className:"prose prose-sm max-w-none text-[13px] leading-relaxed text-[var(--color-text)]",children:e.content.split("\n").map((e,t)=>(0,n.jsx)("p",{className:e.startsWith("**")?"font-medium":"",children:e},t))}),e.response&&e.response.sources.length>0&&(0,n.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,n.jsx)("p",{className:"text-[11px] font-medium uppercase tracking-wider text-[var(--color-text-muted)]",children:"Sources"}),e.response.sources.map(e=>(0,n.jsx)(u,{source:e},e.id))]})]}):(0,n.jsx)("span",{children:e.content})}),"user"===e.role&&(0,n.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-neutral-200",children:(0,n.jsx)(l,{size:14,className:"text-[var(--color-text)]"})})]},t)),(0,n.jsx)("div",{ref:h})]}),(0,n.jsx)("div",{className:"border-t border-[var(--color-border)] p-4",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p()},className:"flex items-center gap-3",children:[(0,n.jsx)("input",{value:r,onChange:e=>a(e.target.value),placeholder:"Ask a support question…",className:"flex-1 rounded-md border border-[var(--color-border)] bg-[var(--color-bg)] px-4 py-2.5 text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:border-[var(--color-accent)] focus:outline-none",disabled:x}),(0,n.jsx)("button",{type:"submit",disabled:x||!r.trim(),className:"flex h-10 w-10 items-center justify-center rounded-md bg-[var(--color-accent)] text-white transition-colors hover:bg-[var(--color-accent-hover)] disabled:opacity-40",children:(0,n.jsx)(c,{size:16})})]})})]})]})}},9621:(e,t,r)=>{Promise.resolve().then(r.bind(r,4086))}},e=>{e.O(0,[441,255,358],()=>e(e.s=9621)),_N_E=e.O()}]);