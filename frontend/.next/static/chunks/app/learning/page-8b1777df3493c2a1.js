(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[169],{960:(e,t,r)=>{"use strict";async function a(e,t){let r=await fetch("".concat("/api").concat(e),{headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},...t});if(!r.ok)throw Error((await r.json().catch(()=>({}))).detail||"Request failed: ".concat(r.status));return r.json()}function s(){return a("/stats")}function l(e){return a("/copilot/ask",{method:"POST",body:JSON.stringify({question:e})})}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=new URLSearchParams({page:String(e),search:t});return a("/knowledge/articles?".concat(r))}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:80;return a("/knowledge/graph?limit=".concat(e))}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=new URLSearchParams({status:e,page:String(t)});return a("/learning/events?".concat(r))}function i(e){return a("/learning/generate-draft",{method:"POST",body:JSON.stringify({ticket_number:e})})}function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return a("/learning/review",{method:"POST",body:JSON.stringify({event_id:e,action:t,reviewer_notes:r})})}function m(e){return a("/qa/score",{method:"POST",body:JSON.stringify({ticket_number:e})})}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=new URLSearchParams({page:String(e),search:t,status:r});return a("/tickets?".concat(s))}r.d(t,{DM:()=>c,Fq:()=>n,H2:()=>m,Ls:()=>d,PF:()=>i,WS:()=>x,YK:()=>s,mF:()=>l,wV:()=>o})},1069:(e,t,r)=>{Promise.resolve().then(r.bind(r,9146))},1362:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},1578:(e,t,r)=>{"use strict";function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,a,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var l=t.length;for(r=0;r<l;r++)t[r]&&(a=e(t[r]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a);return s}(e))&&(a&&(a+=" "),a+=t);return a}(t)}function s(e){return new Intl.NumberFormat().format(e)}function l(e,t){return e.length<=t?e:e.slice(0,t-1)+"…"}function n(e){var t;return null!=(t=({kb_article:"#3B82F6",script:"#8B5CF6",ticket:"#10B981",conversation:"#F59E0B"})[e])?t:"#737373"}function c(e){let t=e.toLowerCase();return"approved"===t?"bg-emerald-50 text-emerald-700 border-emerald-200":"rejected"===t?"bg-red-50 text-red-700 border-red-200":"pending"===t?"bg-amber-50 text-amber-700 border-amber-200":"closed"===t?"bg-neutral-100 text-neutral-600 border-neutral-200":"bg-neutral-50 text-neutral-600 border-neutral-200"}r.d(t,{cn:()=>a,ZV:()=>s,_k:()=>n,ST:()=>c,xv:()=>l})},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(2115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:i="",children:d,iconNode:m,...x}=e;return(0,a.createElement)("svg",{ref:t,...n,width:s,height:s,stroke:r,strokeWidth:o?24*Number(c)/Number(s):c,className:l("lucide",i),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(x)&&{"aria-hidden":"true"},...x},[...m.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:o,...i}=r;return(0,a.createElement)(c,{ref:n,iconNode:t,className:l("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...i})});return r.displayName=s(e),r}},5299:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6983:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7666:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])},8874:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9146:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(5155),s=r(2115),l=r(1362),n=r(8874),c=r(6983),o=r(7666),i=r(9715),d=r(1847);let m=(0,d.A)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]),x=(0,d.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var u=r(5299),h=r(960),v=r(1578);function p(){let[e,t]=(0,s.useState)([]),[r,d]=(0,s.useState)(0),[p,b]=(0,s.useState)(""),[f,g]=(0,s.useState)(1),[j,y]=(0,s.useState)(!0),[N,w]=(0,s.useState)(null),[k,A]=(0,s.useState)(null),[_,S]=(0,s.useState)(!1),[P,C]=(0,s.useState)(null),[z,R]=(0,s.useState)("");async function L(e){S(!0),A(null);try{let t=await (0,h.PF)(e);A(t.data)}catch(e){}finally{S(!1)}}async function M(e,r){C(e);try{let a=await (0,h.Ls)(e,r,z);t(t=>t.map(t=>t.event_id===e?{...t,...a.data}:t)),R("")}catch(e){}finally{C(null)}}return(0,s.useEffect)(()=>{y(!0),(0,h.wV)(p,f).then(e=>{t(e.data),d(e.meta.total)}).catch(()=>{}).finally(()=>y(!1))},[p,f]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Self-Learning Loop"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-[var(--color-text-muted)]",children:"Review detected knowledge gaps and approve or reject auto-generated KB drafts"})]}),(0,a.jsx)("div",{className:"mb-8 rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)] p-5",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:[{icon:o.A,label:"Gap Detected",desc:"Tier 3 ticket resolved, no KB match"},{icon:i.A,label:"Draft Generated",desc:"LLM creates KB article from resolution"},{icon:m,label:"Human Review",desc:"Reviewer approves or rejects with notes"},{icon:l.A,label:"Published",desc:"Article indexed for future retrieval"}].map((e,t)=>{let{icon:r,label:s,desc:l}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-[var(--color-accent)]",children:(0,a.jsx)(r,{size:16,className:"text-white"})}),(0,a.jsx)("p",{className:"mt-2 text-xs font-medium text-[var(--color-text)]",children:s}),(0,a.jsx)("p",{className:"mt-0.5 max-w-32 text-center text-[10px] text-[var(--color-text-muted)]",children:l})]}),t<3&&(0,a.jsx)("div",{className:"mb-8 h-px w-12 bg-[var(--color-border)]"})]},s)})})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[["","Pending","Approved","Rejected"].map(t=>(0,a.jsxs)("button",{onClick:()=>{b(t),g(1)},className:(0,v.cn)("rounded-md px-3 py-1.5 text-xs font-medium transition-colors",p===t?"bg-[var(--color-accent)] text-white":"border border-[var(--color-border)] text-[var(--color-text-muted)] hover:bg-neutral-50"),children:[t||"All"," ","Pending"===t&&r>0?"(".concat(e.filter(e=>"Pending"===e.status).length,")"):""]},t||"all")),(0,a.jsxs)("span",{className:"ml-auto text-xs text-[var(--color-text-muted)]",children:[r," events"]})]}),j?(0,a.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,a.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[var(--color-accent)] border-t-transparent"})}):(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>{var t;let r=N===e.event_id;return(0,a.jsxs)("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]",children:[(0,a.jsxs)("button",{onClick:()=>{w(r?null:e.event_id),A(null)},className:"flex w-full items-center gap-3 p-4 text-left",children:["Approved"===(t=e.status)?(0,a.jsx)(l.A,{size:14,className:"text-emerald-600"}):"Rejected"===t?(0,a.jsx)(n.A,{size:14,className:"text-red-600"}):(0,a.jsx)(c.A,{size:14,className:"text-amber-600"}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[var(--color-text)]",children:(0,v.xv)(e.detected_gap||e.draft_summary,100)}),(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-3",children:[(0,a.jsx)("span",{className:"font-mono text-[10px] text-[var(--color-text-muted)]",children:e.event_id}),(0,a.jsxs)("span",{className:"font-mono text-[10px] text-[var(--color-text-muted)]",children:["Ticket: ",e.ticket_number]})]})]}),(0,a.jsx)("span",{className:(0,v.cn)("rounded-full border px-2 py-0.5 text-[10px] font-medium",(0,v.ST)(e.status)),children:e.status}),(0,a.jsx)(x,{size:14,className:(0,v.cn)("text-[var(--color-text-muted)] transition-transform",r&&"rotate-180")})]}),r&&(0,a.jsxs)("div",{className:"border-t border-[var(--color-border)] p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-[var(--color-text-muted)]",children:"Detected Gap"}),(0,a.jsx)("p",{className:"mt-1 text-[var(--color-text)]",children:e.detected_gap})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-[var(--color-text-muted)]",children:"Draft Summary"}),(0,a.jsx)("p",{className:"mt-1 text-[var(--color-text)]",children:e.draft_summary})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-[var(--color-text-muted)]",children:"Proposed KB ID"}),(0,a.jsx)("p",{className:"mt-1 font-mono text-[var(--color-text)]",children:e.proposed_kb_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-[var(--color-text-muted)]",children:"Conversation"}),(0,a.jsx)("p",{className:"mt-1 font-mono text-[var(--color-text)]",children:e.conversation_id||"N/A"})]})]}),e.ticket_number&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("button",{onClick:()=>L(e.ticket_number),disabled:_,className:"flex items-center gap-2 rounded-md bg-blue-600 px-3 py-2 text-xs font-medium text-white transition-colors hover:bg-blue-700 disabled:opacity-50",children:[_?(0,a.jsx)(u.A,{size:14,className:"animate-spin"}):(0,a.jsx)(i.A,{size:14}),"Generate KB Draft"]})}),k&&N===e.event_id&&(0,a.jsxs)("div",{className:"mt-4 rounded-md border border-blue-200 bg-blue-50 p-4",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-blue-800",children:"Generated KB Draft"}),(0,a.jsx)("p",{className:"mt-2 text-sm font-medium text-[var(--color-text)]",children:k.title}),(0,a.jsx)("div",{className:"mt-2 max-h-48 overflow-y-auto text-xs leading-relaxed text-[var(--color-text)]",children:k.body.split("\n").map((e,t)=>(0,a.jsx)("p",{className:"mt-1",children:e},t))}),k.lineage.length>0&&(0,a.jsxs)("div",{className:"mt-3 border-t border-blue-200 pt-3",children:[(0,a.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-blue-600",children:"Provenance Trail"}),k.lineage.map((e,t)=>(0,a.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-[11px] text-blue-700",children:[(0,a.jsx)(m,{size:12}),(0,a.jsx)("span",{className:"font-mono",children:e.source_id}),(0,a.jsxs)("span",{className:"text-blue-400",children:["(",e.source_type," → ",e.relationship,")"]})]},t))]})]}),"Pending"===e.status&&(0,a.jsxs)("div",{className:"mt-4 border-t border-[var(--color-border)] pt-4",children:[(0,a.jsx)("p",{className:"mb-2 text-xs font-medium text-[var(--color-text)]",children:"Review Decision"}),(0,a.jsx)("textarea",{value:z,onChange:e=>R(e.target.value),placeholder:"Reviewer notes (optional)…",className:"mb-3 w-full rounded-md border border-[var(--color-border)] bg-[var(--color-bg)] p-2.5 text-xs text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:border-[var(--color-accent)] focus:outline-none",rows:2}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>M(e.event_id,"approve"),disabled:P===e.event_id,className:"flex items-center gap-1.5 rounded-md bg-emerald-600 px-4 py-2 text-xs font-medium text-white transition-colors hover:bg-emerald-700 disabled:opacity-50",children:[P===e.event_id?(0,a.jsx)(u.A,{size:14,className:"animate-spin"}):(0,a.jsx)(l.A,{size:14}),"Approve & Publish"]}),(0,a.jsxs)("button",{onClick:()=>M(e.event_id,"reject"),disabled:P===e.event_id,className:"flex items-center gap-1.5 rounded-md border border-red-200 bg-red-50 px-4 py-2 text-xs font-medium text-red-700 transition-colors hover:bg-red-100 disabled:opacity-50",children:[(0,a.jsx)(n.A,{size:14}),"Reject"]})]})]}),"Pending"!==e.status&&e.reviewed_at&&(0,a.jsxs)("div",{className:"mt-4 border-t border-[var(--color-border)] pt-3 text-xs text-[var(--color-text-muted)]",children:["Reviewed by ",e.reviewer_role||"Human Reviewer"," on"," ",new Date(e.reviewed_at).toLocaleString(),e.review_notes&&(0,a.jsxs)("p",{className:"mt-1 italic",children:['"',e.review_notes,'"']})]})]})]},e.event_id)})}),r>20&&(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===f,className:"rounded-md border border-[var(--color-border)] px-3 py-1.5 text-xs text-[var(--color-text-muted)] hover:bg-neutral-50 disabled:opacity-40",children:"Previous"}),(0,a.jsxs)("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Page ",f]}),(0,a.jsx)("button",{onClick:()=>g(e=>e+1),disabled:e.length<20,className:"rounded-md border border-[var(--color-border)] px-3 py-1.5 text-xs text-[var(--color-text-muted)] hover:bg-neutral-50 disabled:opacity-40",children:"Next"})]})]})}},9715:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])}},e=>{e.O(0,[441,255,358],()=>e(e.s=1069)),_N_E=e.O()}]);